{% extends "layout_base.html" %}
{% load avatar_tags %}
{% load markup %}

{% block title %}Thread: {{ topic.title }}{% endblock title %}

{% block breadcrumbs %}
<ul class="breadcrumb">
    <li><a href="{% url 'index' %}">Home</a> <span class="divider">/</span></li>
    <li><a href="{% url 'forums' %}">Forums</a> <span class="divider">/</span></li>
    <li><a href="{% url 'board' name=board.slug %}">Discussion Board</a> <span class="divider">/</span></li>
    <li class="active">Discussion Thread</li>
</ul>
{% endblock breadcrumbs %}

{% block body %}

    <div class="row">
    <form action="{% url 'thread' name=board.slug thread=topic.id %}" method="POST">{% csrf_token %}
        <div class="span10 offset1">
            <h1>{{ topic.title }}</h1>
            
            {% for p in posts %}

            <div class="media well {% if p.author.ta %}well-gold{% endif %}">
                <a class="{% cycle 'pull-left' 'pull-right' %}" href="{% url 'profile' username=p.author.username %}">
                    <img class="img-polaroid" src="{% avatar_url p.author.user 128 %}&d=retro" alt="" />
                </a>
                <div class="media-body">
                    <article>
                    {{ p.content|minimarkup }}
                    </article>
                    <p><small><em>Posted by <a href="{% url 'profile' username=p.author.username %}">{{ p.author.username }}</a>
                    {% if p.author.ta %} (admin) {% endif %}
                    {{ p.timestamp|timesince }} ago.</em></small></p>
                </div>
            </div>

            {% endfor %}
            
            <textarea class="input-block-level" rows="8" name="content"></textarea>
            <button class="btn btn-large btn-success" type="submit" name="thread" value="thread">Post</button>

        </div>
    </form>
    </div>
    {% include "pagination.html" %}

{% endblock body %}

