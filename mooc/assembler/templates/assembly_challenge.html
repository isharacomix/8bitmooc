{% extends "layout_base.html" %}
{% load creole %}
{% load static from staticfiles %}

{% block title %}Challenge {{ world.shortname }}-{{ stage.shortname }}{% endblock title %}

{% block body %}

    <div class="row">
        <form name="input" action="{% url 'challenge' world=world.shortname stage=stage.shortname %}" method="post">{% csrf_token %}
        <div class="span8">
        

            <div>
            
        <ul class="nav nav-tabs">
        {% if stage.lesson %}
        <li><a href="{% url 'lesson' world=world.shortname stage=stage.shortname %}">Lesson</a></li>
        {% endif %}
        <li class="active"><a href="#">Challenge</a></li>
        {% if feedback %}
        <li><a href="{% url 'feedback' world=world.shortname stage=stage.shortname %}">Feedback</a></li>
        {% endif %}
        </ul>

            <div>

                {{ stage.challenge.content|creole }}

            </div>

        <div class="accordion" id="preamble">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#selector" href="#collapse_preamble">
    View Preamble
                    </a>
                </div>
                <div id="collapse_preamble" class="accordion-body collapse">
                    <div class="accordion-inner">
                        <pre>{{ preamble }}</pre>
                    </div>
                </div>
            </div>
        </div>

<textarea class="input-block-level code-input" rows="20" name="code" wrap="soft">{{ source_code }}</textarea>

        <div class="accordion" id="postamble">
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#selector" href="#collapse_postamble">
    View Postamble
                    </a>
                </div>
                <div id="collapse_postamble" class="accordion-body collapse">
                    <div class="accordion-inner">
                        <pre>{{ postamble }}</pre>
                    </div>
                </div>
            </div>
        </div>

            </div>
            
            
            <div class="well">
              {% include "assembler_cheatsheet.html" %}
            </div>
        </div>
        
        
        
        
        
        <div class="span4">
    
        
            <div id="emulator"></div>
    
        
            <input type="submit" name="run" value="Assemble" />
            <input type="submit" name="assemble" value="Download" />
            <button type="button" data-toggle="modal" data-target="#SOS">SOS</button>
        </div>
        
<div id="SOS" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="SOSLabel" aria-hidden="true">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
<h3 id="SOSLabel">Send an S.O.S.</h3>
</div>
<div class="modal-body">
<p>If you are having trouble with this assignment, you can submit an SOS for
your classmates to see if they can help you. If you would like to submit an
SOS, please ask a question below. In your question, please be as specific
as possible about what you are trying to do, and what you are having trouble
with. You can see your classmate's responses on the SOS tab of this stage.</p>
<textarea class="input-block-level" rows="10" name="help"></textarea>
</div>
<div class="modal-footer">
<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
<button class="btn btn-danger" type="submit" name="sos" value="sos">Send my S.O.S.!</button>
</div>
</div>

        </form>
    </div>

{% endblock body %}


{% block scripts %}
    <script src="{% static 'js/dynamicaudio-min.js' %}" type="text/javascript" charset="utf-8"></script>
    <script src="{% static 'js/jsnes.js' %}" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        var nes;
        $(function() {
            nes = new JSNES({
                'swfPath': '{% static "js/" %}',
                'ui': $('#emulator').JSNESUI("/rom/")
            });
        });
    </script>
    <!--[if IE]>
        <script type="text/vbscript" src="source/jsnes-ie-hacks.vbscript"></script>
    <![endif]-->
{% endblock scripts %}

